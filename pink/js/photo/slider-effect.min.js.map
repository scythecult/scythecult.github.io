{"version":3,"sources":["photo/slider-effect.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","_inherits","subClass","superClass","create","value","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","result","Super","_getPrototypeOf","NewTarget","this","Reflect","construct","arguments","apply","_possibleConstructorReturn","self","call","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","SliderEffect","_PhotoUpload","PhotoUpload","_super","_this","Effects","DEFAULT_EFFECT_LEVEL","MAX_SCALE_VALUE","MAX_GRAYSCALE_VALUE","MAX_CONTRAST_VALUE","evt","_this2","preventDefault","control","closest","controlEffectName","dataset","effect","setDataEffect","previewEffectName","_preview","startCoords","Coords","clientX","onMousemove","moveEvt","shift","x","pinCoords","offsetLeft","proportion","Math","round","parentElement","offsetWidth","setInputValue","coords","setEffectDepth","style","left","concat","document","addEventListener","onMouseUp","removeEventListener","_input","setAttribute","effectName","levelValue","prop","abs","removeAttribute"],"mappings":"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","file":"slider-effect.min.js","sourcesContent":["class SliderEffect extends PhotoUpload {\n  constructor() {\n    super();\n    this.Effects = {\n      DEFAULT_EFFECT_LEVEL: 100,\n      MAX_SCALE_VALUE: 5,\n      MAX_GRAYSCALE_VALUE: 1,\n      MAX_CONTRAST_VALUE: 3,\n    };\n  }\n\n  onMousemove(evt) {\n    evt.preventDefault();\n    const control = evt.target.closest(\".effect__slider-control\");\n\n    if (!control) return;\n\n    const controlEffectName = control.dataset.effect;\n    this.setDataEffect(controlEffectName);\n    const previewEffectName = this._preview.dataset.effect;\n    const startCoords = new Coords(evt.clientX);\n\n    const onMousemove = (moveEvt) => {\n      const shift = new Coords(startCoords.x - moveEvt.clientX);\n      const pinCoords = control.offsetLeft - shift.x;\n      const proportion = Math.round(\n        (pinCoords /\n          (control.parentElement.offsetWidth - control.offsetWidth)) *\n          this.Effects.DEFAULT_EFFECT_LEVEL\n      );\n      this.setInputValue(proportion);\n      const restrictRange = () => {\n        const coords = {\n          left: control.offsetLeft,\n          controlWidth: control.offsetWidth,\n          barWidth: control.parentElement.offsetWidth,\n        };\n        if (coords.left < 0) {\n          control.style.left = `${0}px`;\n        }\n        if (coords.left + coords.controlWidth > coords.barWidth) {\n          control.style.left = `${coords.barWidth - coords.controlWidth}px`;\n        }\n      };\n      startCoords.x = moveEvt.clientX;\n\n      this.setEffectDepth(previewEffectName, proportion);\n      restrictRange();\n      control.style.left = `${control.offsetLeft - shift.x}px`;\n    };\n    const onMouseUp = () => {\n      document.removeEventListener(\"mousemove\", onMousemove);\n      document.removeEventListener(\"mouseup\", onMouseUp);\n    };\n\n    document.addEventListener(\"mousemove\", onMousemove);\n    document.addEventListener(\"mouseup\", onMouseUp);\n\n    function Coords(x) {\n      this.x = x;\n    }\n  }\n\n  setInputValue(value) {\n    this._input.setAttribute(\"value\", value);\n  }\n\n  setEffectDepth(effectName, levelValue) {\n    const prop = Math.abs(levelValue / this.Effects.DEFAULT_EFFECT_LEVEL);\n    switch (effectName) {\n      case \"scale\":\n        this._preview.style = `transform: scale(${prop})`;\n        break;\n      case \"grayscale\":\n        this._preview.style = `filter: grayscale(${\n          this.Effects.MAX_GRAYSCALE_VALUE * prop\n        })`;\n        break;\n      case \"contrast\":\n        this._preview.style = `filter: contrast(${\n          this.Effects.MAX_CONTRAST_VALUE * prop\n        })`;\n        break;\n      default:\n        this._preview.removeAttribute(\"style\");\n    }\n  }\n}\n"]}